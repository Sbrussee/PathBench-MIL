Benchmarking Mode
=================

Benchmarking mode in PathBench allows for comprehensive evaluation of different computational pipeline configurations for histopathology tasks. It benchmarks various combinations of normalization methods, feature extractors, and MIL aggregation models.

To configure benchmarking mode, you need to create a configuration file in YAML format. Below is an example configuration file:

.. code-block:: yaml

    experiment:
      project_name: Example_Project
      annotation_file: /path/to/your/annotation_file.csv
      balancing: category
      split_technique: k-fold
      epochs: 5
      batch_size: 32
      bag_size: 512
      k: 2
      val_fraction: 0.1
      aggregation_level: slide
      with_continue: True
      task: classification
      visualization:
        - learning_curve
        - confusion_matrix
        - roc_curve
        - umap
        - mosaic
      mode: benchmark

    benchmark:
      parameters:
        tile_px:
          - 256
        tile_um:
          - 20x
        normalization:
          - macenko
          - reinhard
        feature_extraction:
          - resnet50_imagenet
          - hibou_b
        mil:
          - Attention_MIL
          - dsmil

    datasets:
      - name: dataset_1
        slide_path: /path/to/your/dataset_1/slides
        tfrecord_path: /path/to/your/dataset_1/tfrecords
        tile_path: /path/to/your/dataset_1/tiles
        used_for: training

      - name: dataset_2
        slide_path: /path/to/your/dataset_2/slides
        tfrecord_path: /path/to/your/dataset_2/tfrecords
        tile_path: /path/to/your/dataset_2/tiles
        used_for: testing

When in the appropriate virtual environment:

.. code-block:: bash

    python3 main.py /path/to/your/config_file.yaml

or using the provided script:

.. code-block:: bash

    ./run_pathbench.sh /path/to/your/config_file.yaml
